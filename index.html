<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="description" content="æ—¥æœ¬æ—…éŠä¸­æ—¥ç¿»è­¯å°å¡ç‰‡ - é›¢ç·šå¯ç”¨">
  <meta name="theme-color" content="#0f0f1a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>æ—¥æ—…ç¿»è­¯å¡ç‰‡</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ‡¯ğŸ‡µ</text></svg>">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #0f0f1a;
      --bg-secondary: #1a1a2e;
      --bg-card: rgba(30, 30, 50, 0.85);
      --bg-list: rgba(15, 15, 26, 0.98);
      --text-primary: #ffffff;
      --text-secondary: rgba(255, 255, 255, 0.7);
      --accent-pink: #e94560;
      --accent-gold: #f5a623;
      --glass-border: rgba(255, 255, 255, 0.1);
    }
    .light-mode {
      --bg-primary: #f5f5f7;
      --bg-secondary: #ffffff;
      --bg-card: rgba(255, 255, 255, 0.9);
      --bg-list: rgba(245, 245, 247, 0.98);
      --text-primary: #1a1a2e;
      --text-secondary: rgba(26, 26, 46, 0.7);
      --glass-border: rgba(0, 0, 0, 0.1);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body { height: 100%; overflow: hidden; touch-action: manipulation; }
    body {
      font-family: 'Noto Sans TC', 'Noto Sans JP', -apple-system, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      transition: background 0.3s, color 0.3s;
    }
    .app { display: flex; height: 100%; height: 100dvh; position: relative; }
    .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 90; }
    .overlay.show { display: block; }
    /* å·¦å´åˆ—è¡¨ */
    .sidebar {
      position: fixed; left: 0; top: 0; bottom: 0; width: 240px;
      background: var(--bg-list); border-right: 1px solid var(--glass-border);
      display: flex; flex-direction: column; z-index: 100;
      transform: translateX(-100%); transition: transform 0.3s ease;
    }
    .sidebar.open { transform: translateX(0); }
    @media (min-width: 768px) {
      .sidebar { position: relative; transform: translateX(0); width: 220px; }
      .overlay { display: none !important; }
      .menu-toggle { display: none !important; }
    }
    .sidebar-header {
      padding: 16px; border-bottom: 1px solid var(--glass-border);
      display: flex; align-items: center; justify-content: space-between;
    }
    .logo { display: flex; align-items: center; gap: 8px; font-size: 1rem; font-weight: 700; }
    .logo-icon { font-size: 1.25rem; }
    .close-sidebar { display: none; background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; }
    @media (max-width: 767px) { .close-sidebar { display: block; } }
    .category-tabs { display: flex; padding: 8px; gap: 4px; border-bottom: 1px solid var(--glass-border); }
    .category-tab {
      flex: 1; padding: 10px 4px; background: transparent; border: 1px solid var(--glass-border);
      border-radius: 10px; color: var(--text-secondary); font-size: 1.2rem; cursor: pointer; transition: all 0.2s;
    }
    .category-tab.active { background: var(--accent-pink); color: #fff; border-color: var(--accent-pink); }
    .card-list { flex: 1; overflow-y: auto; padding: 8px; -webkit-overflow-scrolling: touch; }
    .card-list::-webkit-scrollbar { width: 3px; }
    .card-list::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 2px; }
    .card-item {
      padding: 14px 12px; margin-bottom: 4px; background: transparent; border: 1px solid transparent;
      border-radius: 12px; cursor: pointer; transition: all 0.15s; display: flex; align-items: center; gap: 8px;
    }
    .card-item:active { transform: scale(0.98); }
    .card-item.active { background: var(--accent-pink); color: #fff; border-color: var(--accent-pink); }
    .card-item-text { font-size: 0.95rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .card-item-fav { font-size: 0.7rem; opacity: 0; flex-shrink: 0; }
    .card-item.favorited .card-item-fav { opacity: 1; }
    /* å³å´ä¸»å€åŸŸ */
    .main {
      flex: 1; display: flex; flex-direction: column; padding: 12px;
      padding-top: env(safe-area-inset-top, 12px); padding-bottom: env(safe-area-inset-bottom, 12px);
      overflow: hidden; min-width: 0;
    }
    .main-header { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
    .menu-toggle {
      background: var(--bg-card); border: 1px solid var(--glass-border); border-radius: 10px;
      width: 44px; height: 44px; font-size: 1.3rem; cursor: pointer; flex-shrink: 0;
    }
    .search-container { position: relative; flex: 1; min-width: 0; }
    .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); font-size: 0.9rem; opacity: 0.5; }
    .search-input {
      width: 100%; padding: 12px 12px 12px 38px; background: var(--bg-card);
      border: 1px solid var(--glass-border); border-radius: 12px;
      color: var(--text-primary); font-size: 1rem; font-family: inherit;
    }
    .search-input::placeholder { color: var(--text-secondary); }
    .search-input:focus { outline: none; border-color: var(--accent-pink); }
    .header-actions { display: flex; gap: 6px; flex-shrink: 0; }
    .icon-btn {
      background: var(--bg-card); border: 1px solid var(--glass-border); border-radius: 10px;
      width: 44px; height: 44px; font-size: 1.2rem; cursor: pointer; transition: all 0.15s;
    }
    .icon-btn:active { transform: scale(0.95); }
    .icon-btn.active { background: var(--accent-pink); border-color: var(--accent-pink); }
    /* é›™å¡ç‰‡å€åŸŸ */
    .cards-container {
      flex: 1; display: flex; flex-direction: column; gap: 12px; padding: 10px; min-height: 0;
    }
    .card-jp, .card-zh {
      flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 20px; background: var(--bg-card); border: 1px solid var(--glass-border);
      border-radius: 20px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); min-height: 0;
    }
    .card-jp {
      transform: rotate(180deg);
      background: linear-gradient(135deg, var(--accent-pink) 0%, #c73e54 100%);
      border-color: var(--accent-pink);
    }
    .card-label {
      font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px;
      opacity: 0.7; margin-bottom: 8px;
    }
    .ja-text {
      font-size: clamp(1.4rem, 5vw, 2.2rem); font-weight: 700; text-align: center;
      line-height: 1.3; color: #fff;
    }
    .romaji-text {
      margin-top: 8px; font-size: clamp(0.85rem, 2.5vw, 1rem);
      color: rgba(255,255,255,0.8); text-align: center;
    }
    .zh-text {
      font-size: clamp(1.4rem, 5vw, 2.2rem); font-weight: 700; text-align: center; line-height: 1.3;
    }
    .empty-state { display: flex; flex-direction: column; align-items: center; gap: 10px; color: var(--text-secondary); }
    .empty-icon { font-size: 2.5rem; }
    /* åº•éƒ¨æ§åˆ¶ */
    .card-controls { display: flex; align-items: center; justify-content: center; gap: 16px; padding: 12px 0; }
    .nav-btn {
      background: var(--bg-card); border: 1px solid var(--glass-border); border-radius: 50%;
      width: 50px; height: 50px; font-size: 1.2rem; color: var(--text-primary); cursor: pointer; transition: all 0.15s;
    }
    .nav-btn:active { transform: scale(0.92); }
    .favorite-btn {
      background: var(--bg-card); border: 1px solid var(--glass-border); border-radius: 50%;
      width: 50px; height: 50px; font-size: 1.3rem; cursor: pointer; transition: all 0.15s;
      filter: grayscale(1) opacity(0.5);
    }
    .favorite-btn.active { filter: none; background: var(--accent-gold); border-color: var(--accent-gold); }
    .favorite-btn.pop { transform: scale(1.15); }
    .progress-text { font-size: 0.95rem; color: var(--text-secondary); min-width: 55px; text-align: center; }
  </style>
</head>
<body>
  <div class="app">
    <div class="overlay"></div>
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo"><span class="logo-icon">ğŸ‡¯ğŸ‡µ</span><span>æ—¥æ—…ç¿»è­¯å¡ç‰‡</span></div>
        <button class="close-sidebar" aria-label="é—œé–‰">âœ•</button>
      </div>
      <nav class="category-tabs"></nav>
      <div class="card-list"></div>
    </aside>
    <main class="main">
      <div class="main-header">
        <button class="menu-toggle" aria-label="é–‹å•Ÿé¸å–®">â˜°</button>
        <div class="search-container">
          <span class="search-icon">ğŸ”</span>
          <input type="text" class="search-input" placeholder="æœå°‹..." autocomplete="off">
        </div>
        <div class="header-actions">
          <button class="icon-btn fav-filter-btn" aria-label="åªé¡¯ç¤ºæ”¶è—">ğŸ“‹</button>
          <button class="icon-btn theme-toggle" aria-label="åˆ‡æ›ä¸»é¡Œ">â˜€ï¸</button>
        </div>
      </div>
      <div class="cards-container">
        <div class="card-jp">
          <div class="card-label">ğŸ‡¯ğŸ‡µ çµ¦åº—å“¡çœ‹</div>
          <span class="ja-text">ã“ã‚“ã«ã¡ã¯</span>
          <span class="romaji-text">Konnichiwa</span>
        </div>
        <div class="card-zh">
          <div class="card-label">ğŸ‡¹ğŸ‡¼ è‡ªå·±çœ‹</div>
          <span class="zh-text">ä½ å¥½</span>
        </div>
      </div>
      <div class="card-controls">
        <button class="nav-btn prev-btn" aria-label="ä¸Šä¸€å¼µ">â†</button>
        <span class="progress-text">1/20</span>
        <button class="favorite-btn" aria-label="æ”¶è—">â­</button>
        <button class="nav-btn next-btn" aria-label="ä¸‹ä¸€å¼µ">â†’</button>
      </div>
    </main>
  </div>
  <script>
    const cardsData = {
      dining: {
        name: 'é¤é£²', icon: 'ğŸœ',
        cards: [
          { zh: 'è«‹çµ¦æˆ‘èœå–®', ja: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ãã ã•ã„', romaji: 'Menyuu wo kudasai' },
          { zh: 'æˆ‘è¦é»é¤', ja: 'æ³¨æ–‡ã‚’ãŠé¡˜ã„ã—ã¾ã™', romaji: 'Chuumon wo onegai shimasu' },
          { zh: 'æ¨è–¦ä»€éº¼ï¼Ÿ', ja: 'ãŠã™ã™ã‚ã¯ä½•ã§ã™ã‹ï¼Ÿ', romaji: 'Osusume wa nan desu ka?' },
          { zh: 'é€™å€‹æ˜¯ä»€éº¼ï¼Ÿ', ja: 'ã“ã‚Œã¯ä½•ã§ã™ã‹ï¼Ÿ', romaji: 'Kore wa nan desu ka?' },
          { zh: 'è«‹çµ¦æˆ‘é€™å€‹', ja: 'ã“ã‚Œã‚’ãã ã•ã„', romaji: 'Kore wo kudasai' },
          { zh: 'æˆ‘è¦ä¸€ä»½', ja: 'ä¸€ã¤ãã ã•ã„', romaji: 'Hitotsu kudasai' },
          { zh: 'æˆ‘è¦å…©ä»½', ja: 'äºŒã¤ãã ã•ã„', romaji: 'Futatsu kudasai' },
          { zh: 'ä¸è¦è¾£', ja: 'è¾›ãã—ãªã„ã§ãã ã•ã„', romaji: 'Karaku shinaide kudasai' },
          { zh: 'æˆ‘å°â—‹â—‹éæ•', ja: 'â—‹â—‹ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ãŒã‚ã‚Šã¾ã™', romaji: 'â—‹â—‹ arerugii ga arimasu' },
          { zh: 'è«‹çµå¸³', ja: 'ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã—ã¾ã™', romaji: 'Okaikei wo onegai shimasu' },
          { zh: 'å¯ä»¥åˆ·å¡å—ï¼Ÿ', ja: 'ã‚«ãƒ¼ãƒ‰ã¯ä½¿ãˆã¾ã™ã‹ï¼Ÿ', romaji: 'Kaado wa tsukaemasu ka?' },
          { zh: 'å¯ä»¥åˆ†é–‹ä»˜å—ï¼Ÿ', ja: 'åˆ¥ã€…ã«æ‰•ãˆã¾ã™ã‹ï¼Ÿ', romaji: 'Betsubetsu ni haraemasu ka?' },
          { zh: 'è«‹çµ¦æˆ‘æ”¶æ“š', ja: 'ãƒ¬ã‚·ãƒ¼ãƒˆã‚’ãã ã•ã„', romaji: 'Reshiito wo kudasai' },
          { zh: 'å¥½åƒï¼', ja: 'ãŠã„ã—ã„ï¼', romaji: 'Oishii!' },
          { zh: 'æˆ‘åƒé£½äº†', ja: 'ãŠè…¹ã„ã£ã±ã„ã§ã™', romaji: 'Onaka ippai desu' },
          { zh: 'è«‹çµ¦æˆ‘æ°´', ja: 'ãŠæ°´ã‚’ãã ã•ã„', romaji: 'Omizu wo kudasai' },
          { zh: 'å¤–å¸¶', ja: 'æŒã¡å¸°ã‚Š', romaji: 'Mochikaeri' },
          { zh: 'å…§ç”¨', ja: 'åº—å†…ã§', romaji: 'Tennai de' },
          { zh: 'æœ‰ç´ é£Ÿå—ï¼Ÿ', ja: 'ãƒ™ã‚¸ã‚¿ãƒªã‚¢ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', romaji: 'Bejitarian menyuu wa arimasu ka?' },
          { zh: 'è«‹ç­‰ä¸€ä¸‹', ja: 'å°‘ã€…ãŠå¾…ã¡ãã ã•ã„', romaji: 'Shoushou omachi kudasai' }
        ]
      },
      shopping: {
        name: 'è³¼ç‰©', icon: 'ğŸ›ï¸',
        cards: [
          { zh: 'å¤šå°‘éŒ¢ï¼Ÿ', ja: 'ã„ãã‚‰ã§ã™ã‹ï¼Ÿ', romaji: 'Ikura desu ka?' },
          { zh: 'å¯ä»¥è©¦ç©¿å—ï¼Ÿ', ja: 'è©¦ç€ã§ãã¾ã™ã‹ï¼Ÿ', romaji: 'Shichaku dekimasu ka?' },
          { zh: 'æœ‰åˆ¥çš„é¡è‰²å—ï¼Ÿ', ja: 'ä»–ã®è‰²ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', romaji: 'Hoka no iro wa arimasu ka?' },
          { zh: 'æœ‰å¤§ä¸€é»çš„å—ï¼Ÿ', ja: 'ã‚‚ã£ã¨å¤§ãã„ã®ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', romaji: 'Motto ookii no wa arimasu ka?' },
          { zh: 'æœ‰å°ä¸€é»çš„å—ï¼Ÿ', ja: 'ã‚‚ã£ã¨å°ã•ã„ã®ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', romaji: 'Motto chiisai no wa arimasu ka?' },
          { zh: 'æˆ‘è¦é€™å€‹', ja: 'ã“ã‚Œã«ã—ã¾ã™', romaji: 'Kore ni shimasu' },
          { zh: 'æˆ‘åªæ˜¯çœ‹çœ‹', ja: 'è¦‹ã¦ã„ã‚‹ã ã‘ã§ã™', romaji: 'Mite iru dake desu' },
          { zh: 'å¯ä»¥ä¾¿å®œä¸€é»å—ï¼Ÿ', ja: 'å®‰ããªã‚Šã¾ã™ã‹ï¼Ÿ', romaji: 'Yasuku narimasu ka?' },
          { zh: 'å¯ä»¥é€€ç¨…å—ï¼Ÿ', ja: 'å…ç¨ã§ãã¾ã™ã‹ï¼Ÿ', romaji: 'Menzei dekimasu ka?' },
          { zh: 'è«‹å¹«æˆ‘é€€ç¨…', ja: 'å…ç¨æ‰‹ç¶šãã‚’ãŠé¡˜ã„ã—ã¾ã™', romaji: 'Menzei tetsuzuki wo onegai shimasu' },
          { zh: 'é€™æ˜¯å…ç¨…å“', ja: 'ã“ã‚Œã¯å…ç¨å“ã§ã™', romaji: 'Kore wa menzeihin desu' },
          { zh: 'è­·ç…§åœ¨é€™è£¡', ja: 'ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã¯ã“ã¡ã‚‰ã§ã™', romaji: 'Pasupooto wa kochira desu' },
          { zh: 'å¯ä»¥ç”¨ç¾é‡‘å—ï¼Ÿ', ja: 'ç¾é‡‘ã§æ‰•ãˆã¾ã™ã‹ï¼Ÿ', romaji: 'Genkin de haraemasu ka?' },
          { zh: 'è«‹çµ¦æˆ‘è¢‹å­', ja: 'è¢‹ã‚’ãã ã•ã„', romaji: 'Fukuro wo kudasai' },
          { zh: 'ä¸ç”¨è¢‹å­', ja: 'è¢‹ã¯è¦ã‚Šã¾ã›ã‚“', romaji: 'Fukuro wa irimasen' },
          { zh: 'è«‹å¹«æˆ‘åŒ…è£', ja: 'åŒ…è£…ã—ã¦ãã ã•ã„', romaji: 'Housou shite kudasai' },
          { zh: 'é€™æ˜¯ç¦®ç‰©', ja: 'ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆç”¨ã§ã™', romaji: 'Purezento you desu' },
          { zh: 'ç‡Ÿæ¥­åˆ°å¹¾é»ï¼Ÿ', ja: 'ä½•æ™‚ã¾ã§å–¶æ¥­ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ', romaji: 'Nanji made eigyou shite imasu ka?' }
        ]
      },
      hotel: {
        name: 'ä½å®¿', icon: 'ğŸ¨',
        cards: [
          { zh: 'æˆ‘æœ‰é ç´„', ja: 'äºˆç´„ãŒã‚ã‚Šã¾ã™', romaji: 'Yoyaku ga arimasu' },
          { zh: 'æˆ‘è¦è¾¦ç†å…¥ä½', ja: 'ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã‚’ãŠé¡˜ã„ã—ã¾ã™', romaji: 'Chekkuin wo onegai shimasu' },
          { zh: 'æˆ‘è¦é€€æˆ¿', ja: 'ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã‚’ãŠé¡˜ã„ã—ã¾ã™', romaji: 'Chekku auto wo onegai shimasu' },
          { zh: 'è«‹å•WiFiå¯†ç¢¼æ˜¯ï¼Ÿ', ja: 'WiFiã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ', romaji: 'WiFi no pasuwaado wa nan desu ka?' },
          { zh: 'æˆ¿é–“æ€éº¼èµ°ï¼Ÿ', ja: 'éƒ¨å±‹ã¯ã©ã“ã§ã™ã‹ï¼Ÿ', romaji: 'Heya wa doko desu ka?' },
          { zh: 'å¯ä»¥å¯„æ”¾è¡Œæå—ï¼Ÿ', ja: 'è·ç‰©ã‚’é ã‘ã‚‰ã‚Œã¾ã™ã‹ï¼Ÿ', romaji: 'Nimotsu wo azukeraremasu ka?' },
          { zh: 'è«‹å¹«æˆ‘å«è¨ˆç¨‹è»Š', ja: 'ã‚¿ã‚¯ã‚·ãƒ¼ã‚’å‘¼ã‚“ã§ãã ã•ã„', romaji: 'Takushii wo yonde kudasai' },
          { zh: 'æ—©é¤å¹¾é»é–‹å§‹ï¼Ÿ', ja: 'æœé£Ÿã¯ä½•æ™‚ã‹ã‚‰ã§ã™ã‹ï¼Ÿ', romaji: 'Choushoku wa nanji kara desu ka?' },
          { zh: 'æœ‰å¹é¢¨æ©Ÿå—ï¼Ÿ', ja: 'ãƒ‰ãƒ©ã‚¤ãƒ¤ãƒ¼ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', romaji: 'Doraiyaa wa arimasu ka?' },
          { zh: 'å†·æ°£å£äº†', ja: 'ã‚¨ã‚¢ã‚³ãƒ³ãŒå£Šã‚Œã¦ã„ã¾ã™', romaji: 'Eakon ga kowarete imasu' },
          { zh: 'è«‹æ‰“æƒæˆ¿é–“', ja: 'éƒ¨å±‹ã‚’æƒé™¤ã—ã¦ãã ã•ã„', romaji: 'Heya wo souji shite kudasai' },
          { zh: 'è«‹çµ¦æˆ‘æ¯›å·¾', ja: 'ã‚¿ã‚ªãƒ«ã‚’ãã ã•ã„', romaji: 'Taoru wo kudasai' },
          { zh: 'è«‹çµ¦æˆ‘ç‰™åˆ·', ja: 'æ­¯ãƒ–ãƒ©ã‚·ã‚’ãã ã•ã„', romaji: 'Haburashi wo kudasai' },
          { zh: 'ç†±æ°´ä¸ç†±', ja: 'ãŠæ¹¯ãŒå‡ºã¾ã›ã‚“', romaji: 'Oyu ga demasen' },
          { zh: 'å¯ä»¥å»¶å¾Œé€€æˆ¿å—ï¼Ÿ', ja: 'ãƒ¬ã‚¤ãƒˆãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã§ãã¾ã™ã‹ï¼Ÿ', romaji: 'Reito chekku auto dekimasu ka?' },
          { zh: 'é™„è¿‘æœ‰ä¾¿åˆ©å•†åº—å—ï¼Ÿ', ja: 'è¿‘ãã«ã‚³ãƒ³ãƒ“ãƒ‹ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', romaji: 'Chikaku ni konbini wa arimasu ka?' }
        ]
      },
      daily: {
        name: 'æ—¥å¸¸', icon: 'ğŸ‘‹',
        cards: [
          { zh: 'ä½ å¥½', ja: 'ã“ã‚“ã«ã¡ã¯', romaji: 'Konnichiwa' },
          { zh: 'è¬è¬', ja: 'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™', romaji: 'Arigatou gozaimasu' },
          { zh: 'ä¸å¥½æ„æ€', ja: 'ã™ã¿ã¾ã›ã‚“', romaji: 'Sumimasen' },
          { zh: 'å°ä¸èµ·', ja: 'ã”ã‚ã‚“ãªã•ã„', romaji: 'Gomen nasai' },
          { zh: 'è«‹', ja: 'ã©ã†ã', romaji: 'Douzo' },
          { zh: 'æ˜¯çš„', ja: 'ã¯ã„', romaji: 'Hai' },
          { zh: 'ä¸æ˜¯', ja: 'ã„ã„ãˆ', romaji: 'Iie' },
          { zh: 'æˆ‘ä¸æ‡‚æ—¥æ–‡', ja: 'æ—¥æœ¬èªãŒã‚ã‹ã‚Šã¾ã›ã‚“', romaji: 'Nihongo ga wakarimasen' },
          { zh: 'è«‹èªªæ…¢ä¸€é»', ja: 'ã‚†ã£ãã‚Šè©±ã—ã¦ãã ã•ã„', romaji: 'Yukkuri hanashite kudasai' },
          { zh: 'è«‹å¯«ä¸‹ä¾†', ja: 'æ›¸ã„ã¦ãã ã•ã„', romaji: 'Kaite kudasai' },
          { zh: 'å»æ‰€åœ¨å“ªè£¡ï¼Ÿ', ja: 'ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹ï¼Ÿ', romaji: 'Toire wa doko desu ka?' },
          { zh: 'ç­‰ä¸€ä¸‹', ja: 'ã¡ã‚‡ã£ã¨å¾…ã£ã¦ãã ã•ã„', romaji: 'Chotto matte kudasai' },
          { zh: 'æ²’é—œä¿‚', ja: 'å¤§ä¸ˆå¤«ã§ã™', romaji: 'Daijoubu desu' },
          { zh: 'å†è¦‹', ja: 'ã•ã‚ˆã†ãªã‚‰', romaji: 'Sayounara' }
        ]
      }
    };

    class App {
      constructor() {
        this.currentCategory = 'dining';
        this.currentIndex = 0;
        this.favorites = JSON.parse(localStorage.getItem('jp_favorites') || '[]');
        this.searchQuery = '';
        this.filteredCards = [];
        this.isDarkMode = localStorage.getItem('jp_darkMode') !== 'false';
        this.showingFavoritesOnly = false;
      }
      init() {
        this.cacheElements();
        this.bindEvents();
        this.applyTheme();
        this.renderCategories();
        this.updateCards();
        this.initTouch();
      }
      cacheElements() {
        this.jaText = document.querySelector('.ja-text');
        this.romajiText = document.querySelector('.romaji-text');
        this.zhText = document.querySelector('.zh-text');
        this.categoryTabs = document.querySelector('.category-tabs');
        this.cardList = document.querySelector('.card-list');
        this.searchInput = document.querySelector('.search-input');
        this.favoriteBtn = document.querySelector('.favorite-btn');
        this.prevBtn = document.querySelector('.prev-btn');
        this.nextBtn = document.querySelector('.next-btn');
        this.progressText = document.querySelector('.progress-text');
        this.themeToggle = document.querySelector('.theme-toggle');
        this.favFilterBtn = document.querySelector('.fav-filter-btn');
        this.sidebar = document.querySelector('.sidebar');
        this.overlay = document.querySelector('.overlay');
        this.menuToggle = document.querySelector('.menu-toggle');
        this.closeSidebarBtn = document.querySelector('.close-sidebar');
        this.cardsContainer = document.querySelector('.cards-container');
      }
      bindEvents() {
        this.searchInput.addEventListener('input', (e) => {
          this.searchQuery = e.target.value.trim();
          this.currentIndex = 0;
          this.updateCards();
        });
        this.favoriteBtn.addEventListener('click', () => this.toggleFavorite());
        this.prevBtn.addEventListener('click', () => this.prevCard());
        this.nextBtn.addEventListener('click', () => this.nextCard());
        this.themeToggle.addEventListener('click', () => this.toggleTheme());
        this.favFilterBtn.addEventListener('click', () => this.toggleFavoriteFilter());
        this.menuToggle.addEventListener('click', () => this.openSidebar());
        this.closeSidebarBtn.addEventListener('click', () => this.closeSidebar());
        this.overlay.addEventListener('click', () => this.closeSidebar());
        document.addEventListener('keydown', (e) => {
          if (e.target === this.searchInput) return;
          if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') { e.preventDefault(); this.prevCard(); }
          if (e.key === 'ArrowRight' || e.key === 'ArrowDown') { e.preventDefault(); this.nextCard(); }
          if (e.key === 'Escape') this.closeSidebar();
        });
      }
      openSidebar() { this.sidebar.classList.add('open'); this.overlay.classList.add('show'); }
      closeSidebar() { this.sidebar.classList.remove('open'); this.overlay.classList.remove('show'); }
      initTouch() {
        let startX = 0, startY = 0;
        this.cardsContainer.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX; startY = e.touches[0].clientY;
        }, { passive: true });
        this.cardsContainer.addEventListener('touchend', (e) => {
          const diffX = e.changedTouches[0].clientX - startX;
          const diffY = e.changedTouches[0].clientY - startY;
          if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
            if (diffX < 0) this.nextCard(); else this.prevCard();
          }
        }, { passive: true });
      }
      renderCategories() {
        const categories = Object.entries(cardsData);
        this.categoryTabs.innerHTML = categories.map(([key, cat]) => `
          <button class="category-tab ${key === this.currentCategory ? 'active' : ''}" data-category="${key}" title="${cat.name}">${cat.icon}</button>
        `).join('');
        this.categoryTabs.querySelectorAll('.category-tab').forEach(tab => {
          tab.addEventListener('click', () => {
            this.currentCategory = tab.dataset.category;
            this.currentIndex = 0;
            this.searchQuery = '';
            this.searchInput.value = '';
            this.showingFavoritesOnly = false;
            this.favFilterBtn.classList.remove('active');
            this.updateCategories();
            this.updateCards();
          });
        });
      }
      updateCategories() {
        this.categoryTabs.querySelectorAll('.category-tab').forEach(tab => {
          tab.classList.toggle('active', tab.dataset.category === this.currentCategory);
        });
      }
      getFilteredCards() {
        let cards = cardsData[this.currentCategory].cards.map((card, idx) => ({
          ...card, id: `${this.currentCategory}-${idx}`, index: idx
        }));
        if (this.searchQuery) {
          const query = this.searchQuery.toLowerCase();
          cards = cards.filter(card => card.zh.includes(query) || card.ja.includes(query) || card.romaji.toLowerCase().includes(query));
        }
        if (this.showingFavoritesOnly) {
          cards = cards.filter(card => this.favorites.includes(card.id));
        }
        return cards;
      }
      renderCardList() {
        this.cardList.innerHTML = this.filteredCards.map((card, idx) => `
          <div class="card-item ${idx === this.currentIndex ? 'active' : ''} ${this.favorites.includes(card.id) ? 'favorited' : ''}" data-index="${idx}">
            <span class="card-item-fav">â­</span>
            <span class="card-item-text">${card.zh}</span>
          </div>
        `).join('');
        this.cardList.querySelectorAll('.card-item').forEach(item => {
          item.addEventListener('click', () => {
            this.currentIndex = parseInt(item.dataset.index);
            this.updateCardDisplay();
            this.updateListActive();
            if (window.innerWidth < 768) this.closeSidebar();
          });
        });
        const activeItem = this.cardList.querySelector('.card-item.active');
        if (activeItem) activeItem.scrollIntoView({ block: 'nearest' });
      }
      updateListActive() {
        this.cardList.querySelectorAll('.card-item').forEach((item, idx) => {
          item.classList.toggle('active', idx === this.currentIndex);
        });
        const activeItem = this.cardList.querySelector('.card-item.active');
        if (activeItem) activeItem.scrollIntoView({ block: 'nearest' });
      }
      updateCardDisplay() {
        if (this.filteredCards.length === 0) {
          this.jaText.textContent = 'æ‰¾ä¸åˆ°å¡ç‰‡';
          this.romajiText.textContent = '';
          this.zhText.textContent = 'ğŸ”';
          this.progressText.textContent = '0/0';
          this.favoriteBtn.classList.remove('active');
          return;
        }
        if (this.currentIndex >= this.filteredCards.length) this.currentIndex = this.filteredCards.length - 1;
        const card = this.filteredCards[this.currentIndex];
        this.jaText.textContent = card.ja;
        this.romajiText.textContent = card.romaji;
        this.zhText.textContent = card.zh;
        this.progressText.textContent = `${this.currentIndex + 1}/${this.filteredCards.length}`;
        this.favoriteBtn.classList.toggle('active', this.favorites.includes(card.id));
      }
      updateCards() {
        this.filteredCards = this.getFilteredCards();
        this.renderCardList();
        this.updateCardDisplay();
      }
      prevCard() {
        if (this.filteredCards.length === 0) return;
        this.currentIndex = (this.currentIndex - 1 + this.filteredCards.length) % this.filteredCards.length;
        this.updateCardDisplay();
        this.updateListActive();
      }
      nextCard() {
        if (this.filteredCards.length === 0) return;
        this.currentIndex = (this.currentIndex + 1) % this.filteredCards.length;
        this.updateCardDisplay();
        this.updateListActive();
      }
      toggleFavorite() {
        if (this.filteredCards.length === 0) return;
        const card = this.filteredCards[this.currentIndex];
        const idx = this.favorites.indexOf(card.id);
        if (idx === -1) this.favorites.push(card.id);
        else this.favorites.splice(idx, 1);
        localStorage.setItem('jp_favorites', JSON.stringify(this.favorites));
        this.favoriteBtn.classList.toggle('active', idx === -1);
        this.favoriteBtn.classList.add('pop');
        setTimeout(() => this.favoriteBtn.classList.remove('pop'), 200);
        const listItem = this.cardList.querySelectorAll('.card-item')[this.currentIndex];
        if (listItem) listItem.classList.toggle('favorited', idx === -1);
      }
      toggleFavoriteFilter() {
        this.showingFavoritesOnly = !this.showingFavoritesOnly;
        this.favFilterBtn.classList.toggle('active', this.showingFavoritesOnly);
        this.currentIndex = 0;
        this.updateCards();
      }
      toggleTheme() {
        this.isDarkMode = !this.isDarkMode;
        localStorage.setItem('jp_darkMode', this.isDarkMode);
        this.applyTheme();
      }
      applyTheme() {
        document.body.classList.toggle('light-mode', !this.isDarkMode);
        this.themeToggle.textContent = this.isDarkMode ? 'â˜€ï¸' : 'ğŸŒ™';
      }
    }
    document.addEventListener('DOMContentLoaded', () => { new App().init(); });
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(e => console.log('SW error:', e));
    }
  </script>
</body>
</html>
